<?xml version="1.0" encoding="utf-8"?>
<!--
  Combined security-relevant SVG test harness.
  Replace placeholders (ATTACKER.DOM, YOUR-COLLAB.DOM) with your test domains.
  Use only in authorized testing environments.
-->
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     width="1200" height="1000" viewBox="0 0 1200 1000" role="img" aria-label="SVG security test harness">

  <rect width="100%" height="100%" fill="#f8fafc"/>

  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" font-family="Segoe UI, Roboto, Arial" font-size="20" font-weight="700" fill="#111827">
    SVG Security Test Harness — replace placeholders with your test domains
  </text>

  <!-- Section 1: <a> anchor example -->
  <g transform="translate(40,70)">
    <text x="0" y="0" font-size="16" fill="#111827">1) &lt;a&gt; (anchor) — href and xlink:href</text>

    <!-- Anchor with both href and xlink:href -->
    <a href="https://webhook.site/df96e004-51ca-45ec-9cfa-cfa50c3f7c44" xlink:href="https://webhook.site/df96e004-51ca-45ec-9cfa-cfa50c3f7c44"
       target="_blank" rel="noreferrer noopener" tabindex="0">
      <rect x="0" y="18" width="520" height="90" rx="8" fill="#fff" stroke="#e5e7eb"/>
      <text x="260" y="70" text-anchor="middle" font-size="18" fill="#b71c1c">Anchor → https://ATTACKER.DOM/login.html</text>
    </a>

    <text x="0" y="130" font-size="11" fill="#6b7280">(Sanitizers sometimes strip href/xlink:href — check returned SVG.)</text>
  </g>

  <!-- Section 2: <image> external fetch (collaborator/pixel) -->
  <g transform="translate(40,170)">
    <text x="0" y="0" font-size="16" fill="#111827">2) &lt;image&gt; — external fetch / collaborator pixel</text>

    <!-- This image triggers a browser GET to YOUR-COLLAB.DOM/pixel.png if the browser loads it -->
    <rect x="0" y="18" width="520" height="120" rx="8" fill="#ffffff" stroke="#e5e7eb"/>
    <image href="https://webhook.site/df96e004-51ca-45ec-9cfa-cfa50c3f7c44" x="10" y="26" width="1" height="1" preserveAspectRatio="none" />
    <text x="80" y="80" font-size="14" fill="#0b69a3">Image request to: https://YOUR-COLLAB.DOM/pixel.png</text>
    <text x="80" y="102" font-size="11" fill="#6b7280">(use Interact/BurpCollab / watch server logs)</text>
  </g>

  <!-- Section 3: <use> internal symbol + external reference attempt -->
  <g transform="translate(40,320)">
    <text x="0" y="0" font-size="16" fill="#111827">3) &lt;use&gt; — internal &amp; external references</text>

    <!-- Define an internal reusable symbol -->
    <defs>
      <symbol id="icon-lock" viewBox="0 0 24 24">
        <rect x="3" y="10" width="18" height="11" rx="2" fill="#1f6feb"/>
        <path d="M7 10V8a5 5 0 0 1 10 0v2" fill="none" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      </symbol>
    </defs>

    <!-- Use the local symbol -->
    <use xlink:href="#icon-lock" x="0" y="28" width="48" height="48" />

    <text x="70" y="64" font-size="14" fill="#111827">local &lt;use xlink:href="#icon-lock"&gt;</text>

    <!-- Attempt external use (may or may not be allowed) -->
    <!-- Example: xlink:href to an external SVG fragment (replace domain) -->
    <g transform="translate(0,80)">
      <rect x="0" y="0" width="520" height="60" rx="8" fill="#fff" stroke="#e5e7eb"/>
      <text x="10" y="28" font-size="13" fill="#6b7280">External &lt;use&gt; attempt: xlink:href="https://ATTACKER.DOM/external.svg#someId"</text>
      <!-- This is an example only; browsers/CDNs may block or rewrite such references -->
    </g>
  </g>

  <!-- Section 4: Filter + feImage (external resource inside filter) -->
  <g transform="translate(40,460)">
    <text x="0" y="0" font-size="16" fill="#111827">4) &lt;filter&gt; with &lt;feImage&gt; — external resource in a filter chain</text>

    <!-- Define filter using feImage which can cause an external fetch -->
    <defs>
      <filter id="f-external" x="0" y="0" width="1" height="1" filterUnits="objectBoundingBox">
        <!-- feImage historically uses xlink:href; include both for testing -->
        <feImage xlink:href="https://webhook.site/df96e004-51ca-45ec-9cfa-cfa50c3f7c44" href="https://webhook.site/df96e004-51ca-45ec-9cfa-cfa50c3f7c44" result="img"/>
        <feGaussianBlur in="img" stdDeviation="2" result="blur"/>
        <feBlend in="SourceGraphic" in2="blur" mode="normal"/>
      </filter>
    </defs>

    <rect x="0" y="18" width="520" height="120" rx="8" fill="#ffffff" stroke="#e5e7eb"/>
    <text x="260" y="48" text-anchor="middle" font-size="14" fill="#111827">If feImage is loaded, check your collaborator for a GET</text>

    <!-- Apply the filter to a sample element -->
    <rect x="20" y="72" width="120" height="48" rx="8" fill="#fde68a" stroke="#f59e0b" filter="url(#f-external)"/>
    <text x="160" y="100" font-size="12" fill="#6b7280">feImage → https://YOUR-COLLAB.DOM/filter-src.png</text>
  </g>

  <!-- Section 5: <foreignObject> placeholder (HTML) -->
  <g transform="translate(600,70)">
    <text x="0" y="0" font-size="16" fill="#111827">5) &lt;foreignObject&gt; — HTML embedding (often stripped)</text>

    <!-- Put a foreignObject here; many pipelines will remove it -->
    <foreignObject x="0" y="18" width="520" height="160">
      <!-- Use xhtml namespace body; browsers render this if foreignObject is allowed -->
      <body xmlns="http://www.w3.org/1999/xhtml" style="margin:0;font-family:Arial,Helvetica,sans-serif;">
        <div style="padding:8px;background:#fff;border-radius:6px;border:1px solid #e5e7eb;">
          <h3 style="margin:4px 0 8px 0;color:#b71c1c;font-size:16px;">Embedded HTML (foreignObject)</h3>
          <p style="margin:0;font-size:12px;color:#374151;">If preserved, this area contains real HTML elements; many sanitizers remove it.</p>
        </div>
      </body>
    </foreignObject>

    <text x="0" y="190" font-size="11" fill="#6b7280">(If this is stripped by the pipeline, the HTML will not render.)</text>
  </g>

  <!-- Section 6: Visual fallback / demo text -->
  <g transform="translate(600,260)">
    <text x="0" y="0" font-size="16" fill="#111827">6) Visual fallback — shapes & text (always works)</text>
    <rect x="0" y="18" width="520" height="220" rx="8" fill="#ffffff" stroke="#e5e7eb"/>
    <text x="260" y="70" text-anchor="middle" font-size="18" fill="#b71c1c">Visual fallback: This site hacked by Sudhakar</text>
    <text x="260" y="110" text-anchor="middle" font-size="12" fill="#6b7280">Use this for visual PoC screenshots when interactive features are removed.</text>
  </g>

  <!-- Footer guidance text inside the SVG (visible) -->
  <text x="600" y="980" text-anchor="middle" font-size="10" fill="#6b7280">
    Replace ATTACKER.DOM and YOUR-COLLAB.DOM with your test domains. Check returned/transformed SVG and server logs.
  </text>

</svg>
